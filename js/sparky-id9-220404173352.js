/* SPARKY DYNAMICALLY GENERATED JAVASCRIPT - DO NOT EDIT THIS FILE!
YOUR CHANGES WILL BE OVERWRITTEN AFTER NEXT SAVE OF TEMPLATE PARAMETERS!
You can add your custom JavaScript code in template options, under Custom tab or
you can edit file custom.js to add your JavaScript code. */

// Mega menu

(function(jQuery, undefined) {
    jQuery.widget("hjt.megamenu", {
        options: {
            fade: true,
            slide: true,
            animation_speed: "slow",
            down_arrows: true,
            mega_pane_width: 160,
            pane_border_size: 1
        },

        _BaseHTML: "",
        _Container: null,
        _InnerElements: null,
        _AnimatedItem: null,

        _create: function() {
            var self = this,
                options = self.options;
            var $el = jQuery(this.element);

            $el.hide();

            var n = 0;
            $el.find('.separator, a:contains("#LOAD#"), a:contains("#load#"), a:contains("#Load#")').each(function(index) {
                var sHtml = jQuery(jQuery(document).find(".megamenu_separator" + String(n + 1))[0]);
                if (sHtml[0]) {
                    sHtml.remove();
                    jQuery(jQuery(this)[0]).replaceWith(sHtml);
                }
                n++;
            });
            
            $el.addClass("hjt-megamenu-menubar");
            $el.children().addClass("hjt-megamenu-menubar-item");

            $el.show();
            $el.children().each(function(index) {
                if (this.nodeName.toUpperCase() == "LI") {
                    var ULs = jQuery(this).find("UL").length - jQuery(this).find('*[class*="megamenu_separator"] UL').length;
                    if (ULs > 0) {

                        try {
                            if (options.down_arrows) {
                                jQuery(jQuery(this).find("A")[0]).append(jQuery("<span class='hjt-megamenu-menubar-droparrow' >&nbsp;</span>"));
                            }
                        } catch (ecx) {
                        }

                        var Cols = ULs;

                        var i = 0;
                        var sTDs = "";
                        for (i = 0; i < Cols; i++) {
                            sTDs = sTDs + "<div class='hjt-megamenu-dropdown-panel-content' ></div>";
                        }

                        var DropDownDiv = jQuery("<div class='hjt-megamenu-dropdown-panel'><div class='mega_menu_table'>" + sTDs + "</div></div>");

                        var Cells = DropDownDiv.find('.hjt-megamenu-dropdown-panel-content');
                        var c = 0;
                        var r = 0;

                        jQuery(this).children("ul").each(function(index) {
                            jQuery(this).remove();
                            var Multiple = false;
                            var Title = null;

                            jQuery(this).children("li").each(function(index) {
                                jQuery(this).children("ul").each(function(index) {
                                    Multiple = true;
                                    try {
                                        if (this.parentNode.children[0].nodeName != "ul") {
                                            Title = jQuery(this.parentNode.children[0]);
                                            Title.addClass("hjt-megamenu-dropdown-panel-list-title");
                                        }
                                    } catch (exp) { }
                                    if (Title != null) jQuery(Cells[r * Cols + c]).append(Title);
                                    jQuery(Cells[r * Cols + c]).append(jQuery(this));
                                    jQuery(this).addClass("hjt-megamenu-dropdown-panel-list");
                                    c++;
                                    if (c == Cols) {
                                        c = 0;
                                        r++;
                                    }
                                });
                            });

                            if (Multiple == false) {
                                jQuery(Cells[r * Cols + c]).append(jQuery(this));
                                jQuery(this).addClass("hjt-megamenu-dropdown-panel-list");
                                c++;
                                if (c == Cols) {
                                    c = 0;
                                    r++;
                                }
                            }
                        });

                        jQuery(this).append(DropDownDiv);

                        if (DropDownDiv.innerWidth() < jQuery(this).innerWidth()) {
                            DropDownDiv.find(".mega_menu_table").css({ minWidth: jQuery(this).innerWidth() + "px" });
                            DropDownDiv.find(".mega_menu_table").css({ width: jQuery(this).innerWidth() + "px" });
                        }

                        if (options.slide) {
                            DropDownDiv.animate({ height: "toggle" }, 0);
                            DropDownDiv.animate({ height: "toggle" }, 0);
                        }
                    }
                }
                jQuery(this).addClass("hjt-megamenu-menubar-item-normal");
                jQuery(this).bind("mouseenter", { Sender: jQuery(this), Self: self }, self.onBarItem_Enter);
                jQuery(this).bind("mouseleave", { Sender: jQuery(this), Self: self }, self.onBarItem_Leave);
            });
            
            jQuery(window).resize(function(){
                if(self._AnimatedItem){
                    if(self._AnimatedItem.is(":visible")){
                        self.positionDropDown(self._AnimatedItem);
                    }
                }
            });

            // remove empty panels

            jQuery( ".hjt-megamenu-dropdown-panel-content" ).each(function() {
                if ( jQuery(this).children().length == 0 ) {
                    jQuery(this).remove();
                }
            });

            // check if drop-down panel width should be reduced

            var drop_down_panes, drop_down_pane_width, needed_pane_width;

            jQuery( ".hjt-megamenu-menubar-item" ).each(function() {

                drop_down_panes = jQuery(this).find(".hjt-megamenu-dropdown-panel-content").length;
                drop_down_pane_width = jQuery(this).children(".hjt-megamenu-dropdown-panel").width();
                needed_pane_width = drop_down_panes * options.mega_pane_width + options.pane_border_size * 2;

                if (needed_pane_width < drop_down_pane_width) {
                    jQuery(this).children(".hjt-megamenu-dropdown-panel").css("width", needed_pane_width + "px");
                }

            });

            var screenWidth = jQuery("body").width();
            

            // double tap needed on mobiles if menu item is linked and has children

            if( screenWidth < 992 ) {
                jQuery(".touchevents ul.mega").find("li > .hjt-megamenu-dropdown-panel").prev().addClass("firstClick");
            }

            jQuery(".firstClick").on("click", function(e){
                if(jQuery(this).hasClass("firstClick")) {
                    jQuery(this).removeClass("firstClick");
                    e.preventDefault();
                } else {
                    return true;
                }
            });
            
            

        },

        _setOption: function(key, value) {
            this.options[key] = value;
        },

        positionDropDown:function(Panel){
            var offView = (jQuery(window).width() - Panel.parent().offset().left) - Panel.innerWidth();
            var forBorder;

            if (offView > 0) {
                forBorder = 0;
                offView = 0;
                Panel.css("left",(Panel.parent().position().left + offView - forBorder) + "px");
            } else {
                Panel.css("right", 0);
            };
            
            

        },
        onBarItem_Enter: function(eArgs) {
            var Sender = eArgs.data.Sender;
            var options = eArgs.data.Self.options; 
            if(Sender.hasClass("hjt-megamenu-menubar-item-hover")) return;
            Sender.addClass("hjt-megamenu-menubar-item-hover").removeClass("hjt-megamenu-menubar-item-normal");
            var Panels = Sender.find(".hjt-megamenu-dropdown-panel");
            if (Panels.length > 0) {
                if (eArgs.data.Self._AnimatedItem != null) {
                    eArgs.data.Self._AnimatedItem.stop(true, true);
                }
                eArgs.data.Self._AnimatedItem = jQuery(Panels[0]);
                eArgs.data.Self.positionDropDown(eArgs.data.Self._AnimatedItem);
                
                if (options.fade && options.slide) {
                    jQuery(Panels[0]).animate({ opacity: "toggle", height: "toggle" }, options.animation_speed);
                } else if (options.fade) {
                    jQuery(Panels[0]).animate({ opacity: "toggle" }, options.animation_speed);
                } else if (options.slide) {
                    jQuery(Panels[0]).animate({ height: "toggle" }, options.animation_speed);
                } else {
                    jQuery(Panels[0]).show();
                }

                var MaxWidth = 0;
                jQuery(Panels[0]).find(".hjt-megamenu-dropdown-panel-content").each(function(index) {
                    if (jQuery(this).innerWidth() > MaxWidth) {
                        MaxWidth = jQuery(this).innerWidth();
                    }
                });

            }
        },

        onBarItem_Leave: function(eArgs) {
            var Sender = eArgs.data.Sender;
            var options = eArgs.data.Self.options;
            Sender.addClass("hjt-megamenu-menubar-item-normal").removeClass("hjt-megamenu-menubar-item-hover");
            var Panels = Sender.find(".hjt-megamenu-dropdown-panel");
            if (Panels.length > 0) {
                if (eArgs.data.Self._AnimatedItem != null) {
                    eArgs.data.Self._AnimatedItem.stop(true, true);
                }
                eArgs.data.Self._AnimatedItem = jQuery(Panels[0]);
                if (options.fade && options.slide) {
                    jQuery(Panels[0]).animate({ opacity: "toggle", height: "toggle" }, options.animation_speed);
                }
                else if (options.fade) {
                    jQuery(Panels[0]).animate({ opacity: "toggle" }, options.animation_speed);
                }
                else if (options.slide) {
                    jQuery(Panels[0]).animate({ height: "toggle" }, options.animation_speed);
                }
                else {
                    jQuery(Panels[0]).hide();
                }
            }
        },

        destroy: function() {
            jQuery(this.element).html(this._baseHTML);
            jQuery.Widget.prototype.destroy.call(this);
        }

    }); // widget
})(jQuery);


jQuery(document).ready(function() {
    jQuery(".mnu_mainmenu").megamenu({
        fade:true,
        slide:true,
        animation_speed: 300,
        down_arrows:false,
        mega_pane_width: 160,
        pane_border_size: 1

    });
});

/*! modernizr 3.3.1 (Custom Build) | MIT *
 * http://modernizr.com/download/?-touchevents-setclasses !*/
!function(e,n,t){function o(e,n){return typeof e===n}function s(){var e,n,t,s,a,i,r;for(var l in c)if(c.hasOwnProperty(l)){if(e=[],n=c[l],n.name&&(e.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(t=0;t<n.options.aliases.length;t++)e.push(n.options.aliases[t].toLowerCase());for(s=o(n.fn,"function")?n.fn():n.fn,a=0;a<e.length;a++)i=e[a],r=i.split("."),1===r.length?Modernizr[r[0]]=s:(!Modernizr[r[0]]||Modernizr[r[0]]instanceof Boolean||(Modernizr[r[0]]=new Boolean(Modernizr[r[0]])),Modernizr[r[0]][r[1]]=s),f.push((s?"":"no-")+r.join("-"))}}function a(e){var n=u.className,t=Modernizr._config.classPrefix||"";if(p&&(n=n.baseVal),Modernizr._config.enableJSClass){var o=new RegExp("(^|\s)"+t+"no-js(\s|$)");n=n.replace(o,"$1"+t+"js$2")}Modernizr._config.enableClasses&&(n+=" "+t+e.join(" "+t),p?u.className.baseVal=n:u.className=n)}function i(){return"function"!=typeof n.createElement?n.createElement(arguments[0]):p?n.createElementNS.call(n,"http://www.w3.org/2000/svg",arguments[0]):n.createElement.apply(n,arguments)}function r(){var e=n.body;return e||(e=i(p?"svg":"body"),e.fake=!0),e}function l(e,t,o,s){var a,l,f,c,d="modernizr",p=i("div"),h=r();if(parseInt(o,10))for(;o--;)f=i("div"),f.id=s?s[o]:d+(o+1),p.appendChild(f);return a=i("style"),a.type="text/css",a.id="s"+d,(h.fake?h:p).appendChild(a),h.appendChild(p),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(n.createTextNode(e)),p.id=d,h.fake&&(h.style.background="",h.style.overflow="hidden",c=u.style.overflow,u.style.overflow="hidden",u.appendChild(h)),l=t(p,e),h.fake?(h.parentNode.removeChild(h),u.style.overflow=c,u.offsetHeight):p.parentNode.removeChild(p),!!l}var f=[],c=[],d={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,n){var t=this;setTimeout(function(){n(t[e])},0)},addTest:function(e,n,t){c.push({name:e,fn:n,options:t})},addAsyncTest:function(e){c.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr;var u=n.documentElement,p="svg"===u.nodeName.toLowerCase(),h=d._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];d._prefixes=h;var m=d.testStyles=l;Modernizr.addTest("touchevents",function(){var t;if("ontouchstart"in e||e.DocumentTouch&&n instanceof DocumentTouch)t=!0;else{var o=["@media (",h.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");m(o,function(e){t=9===e.offsetTop})}return t}),s(),a(f),delete d.addTest,delete d.addAsyncTest;for(var v=0;v<Modernizr._q.length;v++)Modernizr._q[v]();e.Modernizr=Modernizr}(window,document);
